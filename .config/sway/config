# cf <https://www.chordpro.org/chordpro/pango_markup/>
set $mod Mod4+Ctrl

# exec dbus-update-activation-environment --verbose --systemd --all
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway

exec foot --server
exec gammastep -O 5500K
exec stacki3
exec wvkbd-mobintl --hidden
# Toggle with `pkill -SIGRTMIN wvkbd-mobintl`
exec sway-autoexit-fullscreen
# exec wl-paste -t text --watch clipman store --no-persist

bar {
   id bar0
   swaybar_command waybar
   # hidden_state hide
   mode overlay
   modifier Mod1
   position top
}

client.focused #3d2d22 #3d2d22 #cccccc
client.unfocused #cccccc #dddddd #000000
client.focused_inactive #ffffff #ffffff #000000 

# output * bg #fffaf0 solid_color
output * bg #ffffff solid_color
output HDMI-A-1 {
   mode 1920x1080@60.000Hz
   pos 0 0
}

output 'Unknown Mira133 202105'  {
   mode 2200x1650@38.002Hz
   pos 0 1080
   transform 90
   scale 2
}

output 'Unknown XtendTouch ' {
   mode 1920x1080@60.000Hz
   pos 0 0
   transform 0
   scale 1.5
}

output Virtual-1 {
   mode 1920x1080@60.000Hz
   pos 0 0
   transform 0
   scale 1.5
}


input 10176:2136:WingCoolTouch_WingCoolTouch {
   # map_to_output DVI-I-1
   map_to_output DP-2
   # map_to_region 0 1080 2200x1650
   # map_from_region 0x1080 2200x2730
}
input 1032:12296:Quanta_OpticalTouchScreen {
   map_to_output DVI-I-1
}
input 8746:1:ILITEK_ILITEK-TP {
   map_to_output DP-2
}


input type:keyboard {
    xkb_options compose:menu
    repeat_delay 300
    repeat_rate 45
}

input type:touchpad {
    tap enabled
    dwt enabled
    click_method clickfinger
    tap_button_map lrm
}

# title_window_icon yes
# for_window [] title_format "fdf %title"
smart_gaps off
smart_borders off
hide_edge_borders smart
default_border normal 1
# title_format "%title"
titlebar_border_thickness 1
titlebar_padding 6 2
default_floating_border normal
font Inconsolata 9
gaps inner 0
focus_wrapping workspace

# workspace_layout tabbed
# gaps horizontal 0

# Note: pass the final command to swaymsg so that the resulting window can be opened
# on the original workspace that the command was run on.
set $menu dmenu_path | dmenu | xargs swaymsg exec --

include /etc/sway/config-vars.d/*


floating_modifier Mod4 normal

# Start a terminal
bindsym XF86Terminal exec footclient

bindsym Mod1+Tab exec "npx mira refresh"
bindsym $mod+Tab exec "npx mira refresh"

# Kill focused window
bindsym $mod+z kill

# Start your launcher
# bindsym $mod+semicolon exec dmenu-apps
bindsym XF86MenuKB exec dmenu-apps
bindsym Mod4+XF86MenuKB exec dmenu-apps
bindsym $mod+g exec dmenu-apps
# Pressing Super_L by itself opens the menu
# bindcode 133 --release exec dmenu-apps

# bindsym $mod+t workspace prev
bindsym $mod+x workspace prev
bindsym $mod+c workspace next
bindsym $mod+Shift+x move container to workspace prev
bindsym $mod+Shift+c move container to workspace next

bindsym $mod+b exec "swaylock -i ~/.local/share/wallpaper/diagonal-lines.svg"
bindsym $mod+m exec dmenu-mpv
bindsym $mod+u exec dmenu-thesaurus
# bindsym $mod+p exec "playerctl --player=mpv play-pause"
bindsym $mod+p exec dmenu-pass
bindsym $mod+apostrophe clipman pick -t bemenu

bindsym $mod+comma workspace prev_on_output
bindsym $mod+period workspace next_on_output
bindsym $mod+Shift+comma move container to workspace prev_on_output
bindsym $mod+Shift+period move container to workspace next_on_output

bindsym $mod+i focus prev
bindsym $mod+o focus next

bindsym $mod+t exec foot-cwd
bindsym $mod+Shift+Tab reload

set $left h
set $down j
set $up k
set $right l
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right

bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+Shift+1 move container to workspace number 1; workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2; workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3; workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4; workspace number 4

# bindsym $mod+b splith
# bindsym $mod+v splitv
# bindsym $mod+v splitv

bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

bindsym $mod+v fullscreen

bindsym $mod+Shift+space floating toggle
# bindsym $mod+space focus mode_toggle

bindsym $mod+backspace resize shrink width 10px
bindsym $mod+space resize grow width 10px

# include /etc/sway/config.d/*

# See also https://github.com/francma/wob
set $WOBSOCK $XDG_RUNTIME_DIR/wob.sock
exec rm -f $WOBSOCK && mkfifo $WOBSOCK && tail -f $WOBSOCK | wob
bindsym XF86AudioRaiseVolume exec pamixer -ui 2 && pamixer --get-volume > $WOBSOCK
bindsym XF86AudioLowerVolume exec pamixer -ud 2 && pamixer --get-volume > $WOBSOCK
bindsym XF86AudioMute exec pamixer --toggle-mute && ( [ "$(pamixer --get-mute)" = "true" ] && echo 0 > $WOBSOCK ) || pamixer --get-volume > $WOBSOCK
bindsym XF86MonBrightnessDown exec brightnessctl set 2%- | sed -En 's/.*\(([0-9]+)%\).*/\1/p' > $WOBSOCK
bindsym XF86MonBrightnessUp exec brightnessctl set +2% | sed -En 's/.*\(([0-9]+)%\).*/\1/p' > $WOBSOCK

bindsym XF86AudioRewind exec playerctl position -1
bindsym XF86AudioForward exec playerctl position +1
bindsym XF86AudioPrev exec playerctl prev
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioStop exec playerctl stop
